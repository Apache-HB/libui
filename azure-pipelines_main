# 31 march 2019

jobs:

# vs2015 {

- job: windows_amd64_msvc2015_shared
  displayName: 'Windows amd64 MSVC2015 Shared'
  pool:
    vmImage: 'vs2015-win2012r2'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/vs2015-install-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/windows-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" amd64
      defaultLibrary: shared
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" amd64

- job: windows_amd64_msvc2015_static
  displayName: 'Windows amd64 MSVC2015 Static'
  pool:
    vmImage: 'vs2015-win2012r2'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/vs2015-install-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/windows-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" amd64
      defaultLibrary: static
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" amd64

# }

# vs2017 {

- job: windows_amd64_msvc2017_shared
  displayName: 'Windows amd64 MSVC2017 Shared'
  pool:
    vmImage: 'vs2017-win2016'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/windows-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\VC\Auxiliary\Build\vcvarsall.bat" amd64
      defaultLibrary: shared
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\VC\Auxiliary\Build\vcvarsall.bat" amd64

- job: windows_amd64_msvc2017_static
  displayName: 'Windows amd64 MSVC2017 Static'
  pool:
    vmImage: 'vs2017-win2016'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/windows-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\VC\Auxiliary\Build\vcvarsall.bat" amd64
      defaultLibrary: static
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\VC\Auxiliary\Build\vcvarsall.bat" amd64

# }

# more mac {

- job: darwin_amd64_1012sdk_shared
  displayName: 'Darwin amd64 10.12 SDK Shared'
  pool:
    vmImage: 'macos-10.13'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/darwin-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: export SDKROOT=$(xcodebuild -version -sdk macosx10.12 Path)
      defaultLibrary: shared
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: export SDKROOT=$(xcodebuild -version -sdk macosx10.12 Path)

- job: darwin_amd64_1012sdk_static
  displayName: 'Darwin amd64 10.12 SDK Static'
  pool:
    vmImage: 'macos-10.13'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/darwin-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: export SDKROOT=$(xcodebuild -version -sdk macosx10.12 Path)
      defaultLibrary: static
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: export SDKROOT=$(xcodebuild -version -sdk macosx10.12 Path)

- job: darwin_amd64_1013sdk_shared
  displayName: 'Darwin amd64 10.13 SDK Shared'
  pool:
    vmImage: 'macos-10.13'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/darwin-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: export SDKROOT=$(xcodebuild -version -sdk macosx10.13 Path)
      defaultLibrary: shared
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: export SDKROOT=$(xcodebuild -version -sdk macosx10.13 Path)

- job: darwin_amd64_1013sdk_static
  displayName: 'Darwin amd64 10.13 SDK Static'
  pool:
    vmImage: 'macos-10.13'
  workspace:
    clean: all
  steps:
  - template: azure-pipelines/setup-python3.yml
  - template: azure-pipelines/install-latest-meson.yml
  - template: azure-pipelines/darwin-install.yml
  - template: azure-pipelines/configure.yml
    parameters:
      beforeConfigure: export SDKROOT=$(xcodebuild -version -sdk macosx10.13 Path)
      defaultLibrary: static
  - template: azure-pipelines/build.yml
    parameters:
      beforeBuild: export SDKROOT=$(xcodebuild -version -sdk macosx10.13 Path)

# }
